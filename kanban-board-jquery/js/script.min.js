var JOB_TYPE=["todo","doing","done"],DB={getData:function(){if("undefined"!=typeof Storage){var a;try{a=JSON.parse(localStorage.getItem("list"))||{},JOB_TYPE.forEach(function(b){Array.isArray(a[b])||(a[b]=[])})}catch(b){a={}}return a}return alert("Sorry! Your browser is too old to use this application."),{}},setData:function(a){localStorage.setItem("list",JSON.stringify(a))}},list=DB.getData(),app={init:function(){var a=this;JOB_TYPE.forEach(function(b){var c=list[b]||[];c.forEach(function(c){a.addJobToList(b,c)})}),this.initSortable()},initSortable:function(){var a=this;$(".sorted-list").sortable({connectWith:".sorted-list",placeholder:"ui-state-highlight",start:function(a,b){$(b.item[0]).addClass("dragging"),b.item.oldColumnType=b.item.context.parentElement.getAttribute("id"),b.item.oldItemPosition=b.item.index()},stop:function(b,c){$(c.item[0]).removeClass("dragging");var d=c.item,e=d.oldItemPosition,f=d.oldColumnType,g=d.context.parentElement.getAttribute("id");list[f].splice(e,1),a.updateJobCount(f),list[g].splice(d.index(),0,d[0].innerText),a.updateJobCount(g),DB.setData(list)}})},newJob:function(a,b){var c=$(b).val();"Enter"===event.key&&""!==c&&(list[a]||(list[a]=[]),list[a].push(c),DB.setData(list),this.addJobToList(a,c),$(b).val(""))},addJobToList:function(a,b){var c=$("<div></div>");c.text(b);var d='<div class="collection-item"> '+c.html()+'<span class="badge" onclick="app.deleteJob(this)"><i class="tiny material-icons">delete</i></span></div>';$("#"+a).append(d),this.updateJobCount(a)},deleteJob:function(a){var b=$("#btn-delete"),c=$("#modal-confirm"),d=this;c.openModal(),b.off("click"),b.on("click",function(){var b=$(a).parent(),e=b.parent().attr("id"),f=$("#"+e+" .collection-item").index(b);list[e].splice(f,1),DB.setData(list),b.remove(),d.updateJobCount(e),c.closeModal()})},updateJobCount:function(a){$("#"+a).prev("h5").children(".count").text("("+list[a].length+")")}};$(function(){app.init()});